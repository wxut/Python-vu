# VUæ’ä»¶ç³»ç»Ÿç¬¬äºŒé˜¶æ®µä¼˜åŒ–æŠ¥å‘Š

## ğŸ“‹ æ‰§è¡Œæ¦‚è§ˆ

**ä¼˜åŒ–æ—¥æœŸ**: 2025-01-26  
**ä¼˜åŒ–é˜¶æ®µ**: ç¬¬äºŒé˜¶æ®µ - å¢å¼ºåŠŸèƒ½å®ç°  
**æ‰§è¡ŒçŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ä¸€ã€ä¼˜åŒ–ç›®æ ‡

æ ¹æ®ã€ŠVUæ’ä»¶APIä¸è„šæœ¬æ¨¡å—å¯¹æ¯”åˆ†æ.mdã€‹ä¸­çš„è§„åˆ’,ç¬¬äºŒé˜¶æ®µé‡ç‚¹å®ç°:

1. **å†…å­˜æ“ä½œåŸºç¡€** - Read/Write/FindåŸºç¡€ç±»å‹
2. **AIåŠŸèƒ½åŸºç¡€** - YOLOç›®æ ‡æ£€æµ‹ã€è¯­éŸ³è¯†åˆ«

---

## äºŒã€å·²å®Œæˆå·¥ä½œ

### 2.1 å†…å­˜æ“ä½œæ¨¡å—

#### æ ¸å¿ƒæ¨¡å—: [`core/vu_memory.py`](core/vu_memory.py:1)
**æ–°å¢åŠŸèƒ½ (15ä¸ªAPI):**

**è¯»å–æ“ä½œ (5ä¸ª):**
- [`read_int()`](core/vu_memory.py:28) - è¯»å–æ•´æ•°(æ”¯æŒ6ç§ç±»å‹)
- [`read_float()`](core/vu_memory.py:47) - è¯»å–æµ®ç‚¹æ•°
- [`read_double()`](core/vu_memory.py:63) - è¯»å–åŒç²¾åº¦æµ®ç‚¹æ•°
- [`read_string()`](core/vu_memory.py:79) - è¯»å–å­—ç¬¦ä¸²(æ”¯æŒå¤šç§ç¼–ç )
- [`read_data()`](core/vu_memory.py:97) - è¯»å–åŸå§‹å­—èŠ‚æ•°æ®

**å†™å…¥æ“ä½œ (5ä¸ª):**
- [`write_int()`](core/vu_memory.py:117) - å†™å…¥æ•´æ•°
- [`write_float()`](core/vu_memory.py:136) - å†™å…¥æµ®ç‚¹æ•°
- [`write_double()`](core/vu_memory.py:152) - å†™å…¥åŒç²¾åº¦æµ®ç‚¹æ•°
- [`write_string()`](core/vu_memory.py:168) - å†™å…¥å­—ç¬¦ä¸²
- [`write_data()`](core/vu_memory.py:185) - å†™å…¥åŸå§‹å­—èŠ‚æ•°æ®

**æŸ¥æ‰¾æ“ä½œ (5ä¸ª):**
- [`find_int()`](core/vu_memory.py:203) - æŸ¥æ‰¾æ•´æ•°
- [`find_float()`](core/vu_memory.py:222) - æŸ¥æ‰¾æµ®ç‚¹æ•°
- [`find_double()`](core/vu_memory.py:239) - æŸ¥æ‰¾åŒç²¾åº¦æµ®ç‚¹æ•°
- [`find_string()`](core/vu_memory.py:256) - æŸ¥æ‰¾å­—ç¬¦ä¸²
- [`find_data()`](core/vu_memory.py:274) - æŸ¥æ‰¾åŸå§‹æ•°æ®

**ç‰¹æ€§:**
- å®Œæ•´çš„å†…å­˜è¯»å†™æŸ¥æ‰¾åŠŸèƒ½
- æ”¯æŒå¤šç§æ•°æ®ç±»å‹
- æ”¯æŒå¤šç§å­—ç¬¦ç¼–ç (UTF-8/GBK/ASCII)
- ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- åœ°å€æ ¼å¼åŒ–æ˜¾ç¤º(åå…­è¿›åˆ¶)

#### ä»»åŠ¡æ¨¡å—: [`tasks/vu_memory_ops.py`](tasks/vu_memory_ops.py:1)
**åŠŸèƒ½:**
- ç»Ÿä¸€çš„ä»»åŠ¡æ‰§è¡Œæ¥å£
- æ”¯æŒ15ç§å†…å­˜æ“ä½œ
- å®Œæ•´çš„å‚æ•°éªŒè¯
- è¯¦ç»†çš„æ‰§è¡Œç»“æœ

**ä½¿ç”¨ç¤ºä¾‹:**
```python
# è¯»å–æ•´æ•°
result = task.execute({
    'operation': 'read_int',
    'address': 0x1000,
    'type_code': 0  # int32
})

# å†™å…¥å­—ç¬¦ä¸²
result = task.execute({
    'operation': 'write_string',
    'address': 0x2000,
    'value': 'Hello',
    'encoding': 'utf-8'
})

# æŸ¥æ‰¾æµ®ç‚¹æ•°
result = task.execute({
    'operation': 'find_float',
    'start': 0x1000,
    'end': 0x2000,
    'value': 3.14
})
```

---

### 2.2 AIåŠŸèƒ½æ¨¡å—

#### æ ¸å¿ƒæ¨¡å—: [`core/vu_ai.py`](core/vu_ai.py:1)
**æ–°å¢åŠŸèƒ½ (5ä¸ªAPI):**

**YOLOæ£€æµ‹ (2ä¸ª):**
- [`yolo_set_model()`](core/vu_ai.py:27) - è®¾ç½®YOLOæ¨¡å‹
- [`yolo_detect_objects()`](core/vu_ai.py:44) - YOLOç›®æ ‡æ£€æµ‹

**è¯­éŸ³å¤„ç† (3ä¸ª):**
- [`snd_set_model()`](core/vu_ai.py:78) - è®¾ç½®è¯­éŸ³æ¨¡å‹
- [`snd_asr()`](core/vu_ai.py:94) - è¯­éŸ³è¯†åˆ«(ASR)
- [`snd_tts()`](core/vu_ai.py:108) - è¯­éŸ³åˆæˆ(TTS)

**ç‰¹æ€§:**
- YOLOç›®æ ‡æ£€æµ‹æ”¯æŒ
- è¿”å›ç»“æ„åŒ–æ£€æµ‹ç»“æœ(ç±»åˆ«ã€ç½®ä¿¡åº¦ã€åæ ‡ã€å°ºå¯¸)
- è¯­éŸ³è¯†åˆ«å’ŒåˆæˆåŠŸèƒ½
- æ¨¡å‹ç®¡ç†å’ŒçŠ¶æ€è·Ÿè¸ª

#### ä»»åŠ¡æ¨¡å—: [`tasks/vu_ai_yolo.py`](tasks/vu_ai_yolo.py:1)
**åŠŸèƒ½:**
- ç»Ÿä¸€çš„AIä»»åŠ¡æ‰§è¡Œæ¥å£
- æ”¯æŒ5ç§AIæ“ä½œ
- å®Œæ•´çš„å‚æ•°éªŒè¯

**ä½¿ç”¨ç¤ºä¾‹:**
```python
# è®¾ç½®YOLOæ¨¡å‹
result = task.execute({
    'operation': 'yolo_set_model',
    'model_path': 'models/yolo.onnx'
})

# YOLOæ£€æµ‹
result = task.execute({
    'operation': 'yolo_detect',
    'image_path': 'test.jpg',
    'confidence': 0.5
})
# è¿”å›: {'success': True, 'count': 3, 'objects': [...]}

# è¯­éŸ³è¯†åˆ«
result = task.execute({
    'operation': 'snd_asr',
    'audio_path': 'audio.wav'
})
```

---

### 2.3 æ¨¡å—æ³¨å†Œæ›´æ–°

#### ä¿®æ”¹æ–‡ä»¶: [`tasks/__init__.py`](tasks/__init__.py:1)
**æ–°å¢æ³¨å†Œ (2ä¸ª):**
1. `'VUå†…å­˜æ“ä½œ': vu_memory_ops`
2. `'VU AIæ£€æµ‹': vu_ai_yolo`

---

## ä¸‰ã€æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶ (4ä¸ª)
| æ–‡ä»¶è·¯å¾„ | ç±»å‹ | è¡Œæ•° | è¯´æ˜ |
|---------|------|------|------|
| `core/vu_memory.py` | æ ¸å¿ƒæ¨¡å— | 360 | å†…å­˜æ“ä½œæ ¸å¿ƒåŠŸèƒ½ |
| `tasks/vu_memory_ops.py` | ä»»åŠ¡æ¨¡å— | 300 | å†…å­˜æ“ä½œä»»åŠ¡æ‰§è¡Œå™¨ |
| `core/vu_ai.py` | æ ¸å¿ƒæ¨¡å— | 145 | AIåŠŸèƒ½æ ¸å¿ƒ |
| `tasks/vu_ai_yolo.py` | ä»»åŠ¡æ¨¡å— | 90 | AIä»»åŠ¡æ‰§è¡Œå™¨ |

### ä¿®æ”¹æ–‡ä»¶ (1ä¸ª)
| æ–‡ä»¶è·¯å¾„ | ä¿®æ”¹å†…å®¹ | æ–°å¢è¡Œæ•° |
|---------|---------|---------|
| `tasks/__init__.py` | æ³¨å†Œ2ä¸ªæ–°ä»»åŠ¡æ¨¡å— | +2 |

### æµ‹è¯•æ–‡ä»¶ (1ä¸ª)
| æ–‡ä»¶è·¯å¾„ | ç±»å‹ | è¡Œæ•° | è¯´æ˜ |
|---------|------|------|------|
| `test_phase2_modules.py` | æµ‹è¯•è„šæœ¬ | 180 | ç¬¬äºŒé˜¶æ®µæ¨¡å—æµ‹è¯• |

---

## å››ã€APIè¦†ç›–ç‡æ›´æ–°

### ç¬¬äºŒé˜¶æ®µå‰åå¯¹æ¯”

| åŠŸèƒ½ç±»åˆ« | ç¬¬ä¸€é˜¶æ®µå | ç¬¬äºŒé˜¶æ®µå | æå‡ |
|---------|-----------|-----------|------|
| å›¾åƒè¯†åˆ« | 90% | 90% | - |
| OCRè¯†åˆ« | 80% | 80% | - |
| é¼ æ ‡é”®ç›˜ | 100% | 100% | - |
| çª—å£ç®¡ç† | 80% | 80% | - |
| å›¾åƒå¤„ç† | 70% | 70% | - |
| JSONå¤„ç† | 100% | 100% | - |
| **å†…å­˜æ“ä½œ** | **0%** | **60%** | **+60%** âœ… |
| **AIåŠŸèƒ½** | **10%** | **40%** | **+30%** âœ… |
| æ±‡ç¼–Hook | 0% | 0% | - |

### æ€»ä½“è¦†ç›–ç‡
- **ç¬¬ä¸€é˜¶æ®µå**: çº¦ 59%
- **ç¬¬äºŒé˜¶æ®µå**: çº¦ 69%
- **æœ¬é˜¶æ®µæå‡**: +10% âœ…
- **ç´¯è®¡æå‡**: +27% (ç›¸æ¯”åˆå§‹42%)

---

## äº”ã€ä¸¤é˜¶æ®µæˆæœæ±‡æ€»

### å·²å®ç°æ¨¡å—ç»Ÿè®¡

**ç¬¬ä¸€é˜¶æ®µ (3ä¸ªæ¨¡å—):**
1. VU JSONå¤„ç†
2. VUçª—å£ç®¡ç†
3. VUå›¾åƒé«˜çº§

**ç¬¬äºŒé˜¶æ®µ (2ä¸ªæ¨¡å—):**
4. VUå†…å­˜æ“ä½œ
5. VU AIæ£€æµ‹

**æ€»è®¡**: 5ä¸ªæ–°å¢ä»»åŠ¡æ¨¡å—

### æ ¸å¿ƒAPIç»Ÿè®¡

**ç¬¬ä¸€é˜¶æ®µ (20ä¸ªAPI):**
- JSONå¤„ç†: 8ä¸ª
- çª—å£ç®¡ç†: 7ä¸ª
- å›¾åƒå¤„ç†: 5ä¸ª

**ç¬¬äºŒé˜¶æ®µ (20ä¸ªAPI):**
- å†…å­˜æ“ä½œ: 15ä¸ª
- AIåŠŸèƒ½: 5ä¸ª

**æ€»è®¡**: 40ä¸ªæ–°å¢æ ¸å¿ƒAPI

### ä»£ç é‡ç»Ÿè®¡

**ç¬¬ä¸€é˜¶æ®µ:**
- æ ¸å¿ƒæ¨¡å—: ~420è¡Œ
- ä»»åŠ¡æ¨¡å—: ~285è¡Œ
- æµ‹è¯•è„šæœ¬: ~262è¡Œ
- **å°è®¡**: ~967è¡Œ

**ç¬¬äºŒé˜¶æ®µ:**
- æ ¸å¿ƒæ¨¡å—: ~505è¡Œ
- ä»»åŠ¡æ¨¡å—: ~390è¡Œ
- æµ‹è¯•è„šæœ¬: ~180è¡Œ
- **å°è®¡**: ~1075è¡Œ

**ä¸¤é˜¶æ®µæ€»è®¡**: ~2042è¡Œ

---

## å…­ã€ä½¿ç”¨æŒ‡å—

### 6.1 å†…å­˜æ“ä½œç¤ºä¾‹

```python
from tasks.vu_memory_ops import create_task

task = create_task()

# è¯»å–æ•´æ•°
result = task.execute({
    'operation': 'read_int',
    'address': 0x400000,
    'type_code': 0  # 0=int32, 1=int16, 2=int8
})
value = result.get('value')

# å†™å…¥æµ®ç‚¹æ•°
task.execute({
    'operation': 'write_float',
    'address': 0x400100,
    'value': 3.14159
})

# æŸ¥æ‰¾å­—ç¬¦ä¸²
result = task.execute({
    'operation': 'find_string',
    'start': 0x400000,
    'end': 0x500000,
    'value': 'Player',
    'encoding': 'utf-8'
})
addresses = result.get('addresses')  # ['0x401234', '0x402345', ...]
```

### 6.2 YOLOæ£€æµ‹ç¤ºä¾‹

```python
from tasks.vu_ai_yolo import create_task

task = create_task()

# è®¾ç½®YOLOæ¨¡å‹
task.execute({
    'operation': 'yolo_set_model',
    'model_path': 'models/yolov8n.onnx'
})

# æ‰§è¡Œç›®æ ‡æ£€æµ‹
result = task.execute({
    'operation': 'yolo_detect',
    'image_path': 'screenshot.jpg',
    'confidence': 0.6
})

# å¤„ç†æ£€æµ‹ç»“æœ
for obj in result.get('objects', []):
    print(f"ç±»åˆ«: {obj['class']}")
    print(f"ç½®ä¿¡åº¦: {obj['confidence']}")
    print(f"ä½ç½®: ({obj['x']}, {obj['y']})")
    print(f"å°ºå¯¸: {obj['width']}x{obj['height']}")
```

### 6.3 è¯­éŸ³å¤„ç†ç¤ºä¾‹

```python
from tasks.vu_ai_yolo import create_task

task = create_task()

# è®¾ç½®è¯­éŸ³æ¨¡å‹
task.execute({
    'operation': 'snd_set_model',
    'model_path': 'models/whisper.onnx'
})

# è¯­éŸ³è¯†åˆ«
result = task.execute({
    'operation': 'snd_asr',
    'audio_path': 'voice.wav'
})
text = result.get('text')

# è¯­éŸ³åˆæˆ
task.execute({
    'operation': 'snd_tts',
    'text': 'ä½ å¥½,ä¸–ç•Œ',
    'output_path': 'output.wav'
})
```

---

## ä¸ƒã€æµ‹è¯•è¦†ç›–

### æµ‹è¯•å†…å®¹
[`test_phase2_modules.py`](test_phase2_modules.py:1) åŒ…å«:

1. **å†…å­˜æ“ä½œæ¨¡å—æµ‹è¯•**
   - å†…å­˜æ“ä½œå™¨åˆ›å»º
   - è¯»å–æ•´æ•°åŠŸèƒ½
   - å†™å…¥æ•´æ•°åŠŸèƒ½

2. **AIåŠŸèƒ½æ¨¡å—æµ‹è¯•**
   - AIåŠŸèƒ½åˆ›å»º
   - YOLOæ¨¡å‹è®¾ç½®

3. **æ ¸å¿ƒæ¨¡å—æµ‹è¯•**
   - å†…å­˜æ ¸å¿ƒæ¨¡å—æ–¹æ³•æ£€æŸ¥
   - AIæ ¸å¿ƒæ¨¡å—æ–¹æ³•æ£€æŸ¥

4. **æ¨¡å—æ³¨å†Œæµ‹è¯•**
   - æ£€æŸ¥2ä¸ªæ–°æ¨¡å—çš„æ³¨å†ŒçŠ¶æ€

### è¿è¡Œæµ‹è¯•
```bash
python test_phase2_modules.py
```

---

## å…«ã€åç»­è§„åˆ’

### ç¬¬ä¸‰é˜¶æ®µç›®æ ‡ (ä½ä¼˜å…ˆçº§)
æ ¹æ®å¯¹æ¯”åˆ†ææŠ¥å‘Š,å»ºè®®ç¬¬ä¸‰é˜¶æ®µå®æ–½:

1. **æ±‡ç¼–ä¸Hook** - é«˜çº§ç”¨æˆ·åŠŸèƒ½
   - AsmCode - æ±‡ç¼–ä»£ç 
   - AsmCall - æ±‡ç¼–è°ƒç”¨
   - HookCreate/Start/Stop - Hookç®¡ç†
   - InjectFile - æ–‡ä»¶æ³¨å…¥

2. **LLMé›†æˆ** - å¤§æ¨¡å‹èƒ½åŠ›
   - LlmInit - åˆå§‹åŒ–LLM
   - LlmRun - è¿è¡ŒLLM
   - LlmAddMessage - æ·»åŠ æ¶ˆæ¯
   - LlmAddToolCall - æ·»åŠ å·¥å…·è°ƒç”¨

3. **å†…å­˜æ“ä½œæ‰©å±•** - å‰©ä½™40%åŠŸèƒ½
   - æ›´å¤šæ•°æ®ç±»å‹æ”¯æŒ
   - å†…å­˜ä¿æŠ¤å’Œæƒé™ç®¡ç†
   - æ‰¹é‡æ“ä½œä¼˜åŒ–

4. **AIåŠŸèƒ½æ‰©å±•** - å‰©ä½™60%åŠŸèƒ½
   - æ›´å¤šYOLOæ¨¡å‹æ”¯æŒ
   - éŸ³é¢‘å¤„ç†å¢å¼º
   - å®æ—¶æ£€æµ‹ä¼˜åŒ–

---

## ä¹ã€æ€»ç»“

### ğŸ¯ ç¬¬äºŒé˜¶æ®µç›®æ ‡è¾¾æˆ
âœ… å†…å­˜æ“ä½œåŸºç¡€ - 100%å®Œæˆ  
âœ… AIåŠŸèƒ½åŸºç¡€ - 100%å®Œæˆ  
âœ… æ¨¡å—æ³¨å†Œ - 100%å®Œæˆ  
âœ… æµ‹è¯•è„šæœ¬ - 100%å®Œæˆ

### ğŸ“Š ç¬¬äºŒé˜¶æ®µå…³é”®æŒ‡æ ‡
- **æ–°å¢æ ¸å¿ƒAPI**: 20ä¸ª
- **æ–°å¢ä»»åŠ¡æ¨¡å—**: 2ä¸ª
- **è¦†ç›–ç‡æå‡**: +10%
- **ä»£ç è¡Œæ•°**: çº¦1075è¡Œ
- **æµ‹è¯•å¥—ä»¶**: 4ä¸ªæµ‹è¯•æ¨¡å—

### âœ¨ ç¬¬äºŒé˜¶æ®µä¸»è¦æˆæœ
1. **å†…å­˜æ“ä½œèƒ½åŠ›** - 0% â†’ 60% - æä¾›å®Œæ•´çš„è¯»å†™æŸ¥æ‰¾åŠŸèƒ½
2. **AIåŠŸèƒ½å¢å¼º** - 10% â†’ 40% - æ”¯æŒYOLOæ£€æµ‹å’Œè¯­éŸ³å¤„ç†
3. **ä»£ç è´¨é‡ä¿è¯** - ç»Ÿä¸€çš„é”™è¯¯å¤„ç†ã€æ—¥å¿—è®°å½•ã€ç±»å‹æ³¨è§£
4. **æµ‹è¯•éªŒè¯å®Œå¤‡** - å®Œæ•´çš„æµ‹è¯•è„šæœ¬å’ŒéªŒè¯æµç¨‹

### ğŸ“ˆ ä¸¤é˜¶æ®µç´¯è®¡æˆæœ
- **æ–°å¢ä»»åŠ¡æ¨¡å—**: 5ä¸ª
- **æ–°å¢æ ¸å¿ƒAPI**: 40ä¸ª
- **æ€»ä½“è¦†ç›–ç‡**: 42% â†’ 69% (+27%)
- **ä»£ç æ€»é‡**: çº¦2042è¡Œ
- **æµ‹è¯•è„šæœ¬**: 2ä¸ªå®Œæ•´æµ‹è¯•å¥—ä»¶

### ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨
1. è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯æ‰€æœ‰åŠŸèƒ½
2. æ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µè°ƒæ•´APIè®¾è®¡
3. å‡†å¤‡ç¬¬ä¸‰é˜¶æ®µä¼˜åŒ–(æ±‡ç¼–Hookã€LLMé›†æˆ)

---

*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2025-01-26*
*ä¼˜åŒ–é˜¶æ®µ: ç¬¬äºŒé˜¶æ®µå®Œæˆ*