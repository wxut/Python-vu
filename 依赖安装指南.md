# 依赖安装指南

## 当前缺失的依赖包

根据依赖检查结果，以下包需要安装：

- **PySide6** - GUI框架（程序启动必需）
- **numpy** - 数值计算库（OCR功能需要）

## 安装方法

### 方法1：使用pip命令（推荐）

打开命令提示符（CMD）或PowerShell，执行以下命令：

```cmd
pip install PySide6 numpy
```

### 方法2：运行批处理文件

直接双击运行以下文件：

```
wy\install_dependencies.bat
```

## 验证安装

安装完成后，运行以下命令验证：

```cmd
python wy/check_dependencies.py
```

如果所有依赖都已安装，会显示：

```
============================================================
依赖包检查
============================================================
[OK] PySide6         - 已安装
[OK] numpy           - 已安装
[OK] psutil          - 已安装
[OK] keyboard        - 已安装
[OK] wmi             - 已安装
[OK] pywin32         - 已安装
============================================================

所有 6 个依赖包已正确安装！
可以运行程序了: python wy/main.py
```

## 运行程序

依赖安装完成后，运行以下命令启动程序：

```cmd
python wy/main.py
```

## 验证修复效果

程序启动后：

1. 点击工具栏中的"全局设置"按钮
2. 在"执行模式设置"部分，检查"执行模式"下拉框
3. 确认下拉框显示全部6个选项：
   - 前台模式一
   - 前台模式二
   - 后台模式一
   - 后台模式二
   - MuMu模拟器
   - 雷电模拟器
4. 在"双模式选择"部分，确认3个单选按钮显示正确：
   - 自动模式（推荐）
   - VU插件模式
   - Python模式
5. 确认两个设置互不干扰，可以独立选择

## 常见问题

### Q: pip 命令找不到？
A: 确保Python已正确安装并添加到系统PATH环境变量中。

### Q: 安装速度很慢？
A: 可以使用国内镜像源加速：
```cmd
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple PySide6 numpy
```

### Q: 权限错误？
A: 以管理员身份运行命令提示符，或使用：
```cmd
pip install --user PySide6 numpy